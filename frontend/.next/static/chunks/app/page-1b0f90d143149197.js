(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{733:(e,t,s)=>{Promise.resolve().then(s.bind(s,5462))},5462:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var r=s(5155),a=s(2115),n=s(2822),o=s(2619),l=s.n(o),i=s(9293);let d=e=>{let{label:t,isActive:s,onClick:a,icon:n}=e;return(0,r.jsxs)("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 ".concat(s?"bg-brand-blue text-white shadow-md":"text-gray-600 hover:bg-gray-200 hover:text-gray-900"),children:[n,t]})},c=e=>{let{currentView:t,setCurrentView:s,currentUser:a}=e,{logout:n}=(0,i.A)();return(0,r.jsx)("header",{className:"bg-white shadow-md sticky top-0 z-10",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-3 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("svg",{className:"w-8 h-8 text-brand-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,r.jsx)("h1",{className:"text-xl md:text-2xl font-bold text-brand-dark",children:"RIFI"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("nav",{className:"flex items-center gap-2 p-1 bg-gray-100 rounded-lg",children:[(0,r.jsx)(d,{label:"Dashboard",isActive:"dashboard"===t,onClick:()=>s("dashboard"),icon:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})})}),(0,r.jsx)(d,{label:"Report Issue",isActive:"report"===t,onClick:()=>s("report"),icon:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})})}),"admin"===a.role&&(0,r.jsx)(l(),{href:"/admin",className:"px-4 py-2 rounded-md text-sm font-medium text-gray-600 hover:bg-gray-200 hover:text-gray-900",children:"Admin"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-sm text-gray-500 hidden md:block",children:a.email}),(0,r.jsx)("button",{onClick:n,className:"p-2 rounded-full text-gray-500 hover:bg-red-100 hover:text-red-600 transition-colors","aria-label":"Logout",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"})})})]})]})]})})};var u=s(3961);let m=s(5704).env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:5000";async function h(e){try{let t=u.j2.currentUser;if(!t)return;let s=await t.getIdToken(),r=await fetch("".concat(m,"/api/ai/process-issue"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({issue_id:e})});if(!r.ok){let e=await r.text();console.warn("processIssue failed",r.status,e)}}catch(e){console.warn("processIssue error",e)}}var x=s(5602);let b=e=>{let{onIssueAdded:t}=e,[s,o]=(0,a.useState)(""),[l,i]=(0,a.useState)(""),[d,c]=(0,a.useState)(null),[u,m]=(0,a.useState)(null),[b,g]=(0,a.useState)(null),[p,f]=(0,a.useState)(null),[w,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)("idle"),[N,k]=(0,a.useState)(0),C=(0,a.useRef)(null),S=async e=>{if(e.preventDefault(),!s||!l||!d||!b)return void f("Please fill in all fields, upload a photo, and provide your location.");f(null);try{v("analyzing");let{tags:e,summary:r,priority:a}=await x.oG(l,u,d.type);v("uploading"),k(0);let o=await n.ZJ({title:s,description:l,summary:r,photoFile:d,tags:e,priority:a,location:b},e=>{k(e)});v("submitting"),(null==o?void 0:o.id)&&h(o.id),t()}catch(e){console.error("Submission Error:",e),"storage/unauthorized"===e.code?f("Submission failed due to a permissions error. Please update your Firebase Storage security rules to allow uploads. This is a necessary one-time setup step."):"storage/bucket-not-found"===e.code||"storage/project-not-found"===e.code?f("Submission failed: Firebase Storage has not been activated. Please go to your Firebase Console, find the Storage section, and click the 'Get Started' button to enable it. The upload will work immediately after that."):"storage/retry-limit-exceeded"===e.code?f("The upload timed out. This may be due to a slow network connection or a misconfiguration of your Firebase project's 'storageBucket' URL. Please verify your connection and config settings."):"UploadTimeout"===e.name?f("The upload took too long and timed out. This often happens if Firebase Storage is not enabled or if the `storageBucket` URL in your configuration is incorrect. Please double-check your Firebase project setup and your network connection."):"permission-denied"===e.code?f("Submission failed: Firestore permission denied. Please check your security rules to ensure authenticated users can create documents in the 'issues' collection."):f("An error occurred: ".concat(e.message||"Please try again."))}finally{v("idle"),k(0)}},L="idle"!==j;return(0,r.jsxs)("div",{className:"max-w-2xl mx-auto bg-white p-6 md:p-8 rounded-xl shadow-lg",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-brand-dark mb-6",children:"Report a New Issue"}),(0,r.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Issue Title"}),(0,r.jsx)("input",{type:"text",id:"title",value:s,onChange:e=>o(e.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-brand-blue focus:border-brand-blue sm:text-sm",placeholder:"e.g., Large Pothole on Main St",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{id:"description",rows:4,value:l,onChange:e=>i(e.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-brand-blue focus:border-brand-blue sm:text-sm",placeholder:"Provide details about the issue...",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Photo of the Issue"}),(0,r.jsx)("div",{className:"mt-1 flex items-center justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:(0,r.jsxs)("div",{className:"space-y-1 text-center",children:[u?(0,r.jsx)("img",{src:u,alt:"Issue preview",className:"mx-auto h-48 w-auto rounded-lg"}):(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,r.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,r.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-brand-blue hover:text-brand-dark focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-brand-blue",children:[(0,r.jsx)("span",{children:d?"Change photo":"Upload a photo"}),(0,r.jsx)("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0];c(t);let s=new FileReader;s.onloadend=()=>{m(s.result)},s.readAsDataURL(t)}},ref:C,required:!0})]}),(0,r.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),(0,r.jsxs)("div",{className:"mt-1",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{y(!0),f(null),navigator.geolocation.getCurrentPosition(e=>{g({lat:e.coords.latitude,lon:e.coords.longitude}),y(!1)},e=>{f("Error getting location: ".concat(e.message)),y(!1)},{enableHighAccuracy:!0})},disabled:w,className:"w-full flex justify-center items-center gap-2 px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-brand-lightblue hover:bg-brand-blue focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue disabled:bg-gray-400",children:w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Fetching..."]}):"Get Current Location"}),b&&(0,r.jsxs)("p",{className:"mt-2 text-sm text-green-600",children:["Location captured: ",b.lat.toFixed(5),", ",b.lon.toFixed(5)]})]})]}),p&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:p}),(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsxs)("button",{type:"submit",disabled:L,className:"w-full relative overflow-hidden flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-brand-blue hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue disabled:bg-gray-400",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 z-10",children:[L&&(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{children:(()=>{switch(j){case"analyzing":return"Analyzing with AI...";case"uploading":if(N<100)return"Uploading Photo (".concat(N,"%)...");return"Finalizing Report...";case"submitting":return"Saving Report...";default:return"Submit Report"}})()})]}),"uploading"===j&&(0,r.jsx)("div",{className:"absolute top-0 left-0 h-full bg-blue-700 transition-all duration-150 ease-linear",style:{width:"".concat(N,"%")}})]})})]})]})};var g=s(6059);let p=e=>{let{onSendMessage:t}=e,[s,n]=(0,a.useState)(!1),[o,l]=(0,a.useState)([{sender:"bot",text:"Hello! How can I help? You can ask for the status of a report by its ID (e.g., 'Status of 5aBcDeF6gHiJkL7mNoPq')."}]),[i,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(!1),m=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e;null==(e=m.current)||e.scrollIntoView({behavior:"smooth"})},[o]);let h=async e=>{if(e.preventDefault(),""===i.trim())return;let s={text:i,sender:"user"};l(e=>[...e,s]),d(""),u(!0);let r={text:await t(i),sender:"bot"};l(e=>[...e,r]),u(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>n(!s),className:"fixed bottom-6 right-6 bg-brand-blue text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center transition-transform transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue z-20","aria-label":"Toggle chatbot",children:s?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s&&(0,r.jsxs)("div",{className:"fixed bottom-24 right-4 sm:right-6 w-[90vw] max-w-md h-[70vh] sm:h-[28rem] bg-white rounded-lg shadow-2xl flex flex-col z-20 transition-opacity duration-300 animate-fade-in-up",children:[(0,r.jsx)("header",{className:"bg-brand-blue text-white p-4 rounded-t-lg",children:(0,r.jsx)("h3",{className:"font-bold text-lg",children:"City Helper Bot"})}),(0,r.jsx)("main",{className:"flex-1 p-4 overflow-y-auto bg-gray-50",children:(0,r.jsxs)("div",{className:"space-y-4",children:[o.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-end gap-2 ".concat("user"===e.sender?"justify-end":"justify-start"),children:["bot"===e.sender&&(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-brand-blue text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"AI"}),(0,r.jsx)("div",{className:"px-4 py-2 rounded-lg max-w-xs ".concat("user"===e.sender?"bg-brand-lightblue text-white rounded-br-none":"bg-gray-200 text-brand-dark rounded-bl-none"),children:(0,r.jsx)("p",{className:"text-sm",children:e.text})})]},t)),c&&(0,r.jsxs)("div",{className:"flex items-end gap-2 justify-start",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-brand-blue text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"AI"}),(0,r.jsx)("div",{className:"px-4 py-2 rounded-lg bg-gray-200 text-brand-dark rounded-bl-none",children:(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce [animation-delay:-0.3s]"}),(0,r.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce [animation-delay:-0.15s]"}),(0,r.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce"})]})})]}),(0,r.jsx)("div",{ref:m})]})}),(0,r.jsx)("footer",{className:"p-2 border-t border-gray-200",children:(0,r.jsxs)("form",{onSubmit:h,className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"text",value:i,onChange:e=>{d(e.target.value)},placeholder:"Type your message...",className:"flex-1 px-4 py-2 bg-white border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-brand-blue text-sm"}),(0,r.jsx)("button",{type:"submit",className:"bg-brand-blue text-white p-2 rounded-full hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})})]}),(0,r.jsx)("style",{children:"\n                @keyframes fade-in-up {\n                    from { opacity: 0; transform: translateY(10px); }\n                    to { opacity: 1; transform: translateY(0); }\n                }\n                .animate-fade-in-up {\n                    animation: fade-in-up 0.3s ease-out forwards;\n                }\n            "})]})};var f=s(2853);let w=()=>{let[e,t]=(0,a.useState)(!0),[s,n]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[d,c]=(0,a.useState)("user"),[u,m]=(0,a.useState)(null),[h,x]=(0,a.useState)(!1),{setCurrentUser:b}=(0,i.A)(),g=async t=>{t.preventDefault(),m(null),x(!0);try{let t;if(e){if(!(t=await f.iD(s,o,d)))throw Error("Invalid credentials or role selection.")}else t=await f.Hh(s,o,d);b(t)}catch(e){console.error("Auth Error:",e),"permission-denied"===e.code||e.message&&e.message.toLowerCase().includes("permission")?m("Database permission error. Please check your Firestore security rules in the Firebase console. This is a required setup step."):"auth/configuration-not-found"===e.code?m("Firebase Authentication is not configured. Please go to your Firebase Console, navigate to Authentication -> Sign-in method, and enable the 'Email/Password' provider."):"auth/invalid-credential"===e.code||"auth/user-not-found"===e.code||"auth/wrong-password"===e.code?m("Invalid email, password, or role selection. Please check your credentials and try again."):"auth/email-already-in-use"===e.code?m("An account with this email address already exists. Please try logging in or use a different email."):m(e.message||"An unexpected error occurred.")}finally{x(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-brand-gray flex flex-col justify-center items-center p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-8",children:[(0,r.jsxs)("svg",{className:"w-10 h-10 text-brand-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-brand-dark",children:"RIFI (Report It, Fix It)"})]}),(0,r.jsxs)("div",{className:"w-full max-w-md bg-white p-8 rounded-xl shadow-lg",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-center text-brand-dark mb-2",children:e?"Welcome Back!":"Create Account"}),(0,r.jsx)("p",{className:"text-center text-gray-500 mb-6",children:e?"Log in to continue":"Sign up to start reporting issues"}),(0,r.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,r.jsx)(()=>(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e?"Log in as:":"Sign up as:"}),(0,r.jsxs)("div",{className:"flex w-full rounded-md shadow-sm",children:[(0,r.jsx)("button",{type:"button",onClick:()=>c("user"),className:"w-1/2 rounded-l-md px-4 py-2 text-sm font-medium border ".concat("user"===d?"bg-brand-blue text-white border-brand-blue z-10":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:"User"}),(0,r.jsx)("button",{type:"button",onClick:()=>c("admin"),className:"w-1/2 -ml-px rounded-r-md px-4 py-2 text-sm font-medium border ".concat("admin"===d?"bg-brand-blue text-white border-brand-blue z-10":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:"Admin"})]})]}),{}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),(0,r.jsx)("input",{type:"email",id:"email",value:s,onChange:e=>n(e.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-brand-blue focus:border-brand-blue",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,r.jsx)("input",{type:"password",id:"password",value:o,onChange:e=>l(e.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-brand-blue focus:border-brand-blue",required:!0})]}),u&&(0,r.jsx)("p",{className:"text-sm text-red-600 text-center p-2 bg-red-50 rounded-md border border-red-200",children:u}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"submit",disabled:h,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-brand-blue hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue disabled:bg-gray-400",children:h?(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e?"Log In":"Sign Up"})})]}),(0,r.jsxs)("p",{className:"mt-6 text-center text-sm text-gray-600",children:[e?"Don't have an account?":"Already have an account?",(0,r.jsx)("button",{onClick:()=>{t(!e),m(null)},className:"font-medium text-brand-blue hover:text-brand-dark ml-1",children:e?"Sign Up":"Log In"})]})]}),(0,r.jsxs)("div",{className:"text-center mt-4 max-w-md text-xs text-gray-500",children:[(0,r.jsxs)("p",{children:["These test accounts don't exist by default. You must ",(0,r.jsx)("strong",{className:"font-medium",children:"Sign Up"})," with them first."]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{className:"font-medium",children:"Admin:"})," admin@city.com / adminpassword"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{className:"font-medium",children:"User:"})," user@example.com / userpassword"]})]})]})};var y=s(9708);let j=()=>{let{currentUser:e}=(0,i.A)(),[t,s]=(0,a.useState)([]),[o,l]=(0,a.useState)("dashboard"),[d,m]=(0,a.useState)(!0);(0,a.useEffect)(()=>{if(!e){m(!1),s([]);return}let t=async()=>{let e=(0,y.rJ)(u.db,"issues"),t=(0,y.P)(e,(0,y.AB)(1));(await (0,y.GG)(t)).empty&&(console.log("Database is empty. Seeding with initial data..."),await n.Iz())};m(!0),t();let r=(0,y.rJ)(u.db,"issues"),a=(0,y.P)(r,(0,y.My)("createdAt","desc")),o=(0,y.aQ)(a,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),s(t),m(!1)},e=>{console.error("Error fetching issues from Firestore: ",e),m(!1)});return()=>o()},[e]);let h=async(e,t)=>{await n.vD(e,t)},f=async(e,t)=>{await n.rA(e,t)},j=async e=>{let t=e.match(/\b[a-zA-Z0-9]{20}\b/);return await (0,x.JE)(t?t[0]:"")};return e?(0,r.jsxs)("div",{className:"min-h-screen bg-brand-gray text-brand-dark",children:[(0,r.jsx)(c,{currentView:o,setCurrentView:l,currentUser:e}),(0,r.jsx)("main",{className:"container mx-auto p-4 md:p-6 lg:p-8",children:"dashboard"===o?(0,r.jsx)(g.A,{issues:t,isLoading:d,currentUser:e,onStatusChange:h,onPriorityChange:f}):(0,r.jsx)(b,{onIssueAdded:()=>{l("dashboard")}})}),(0,r.jsx)(p,{onSendMessage:j})]}):(0,r.jsx)(w,{})};function v(){return(0,r.jsx)(j,{})}}},e=>{e.O(0,[135,965,31,619,227,441,255,358],()=>e(e.s=733)),_N_E=e.O()}]);