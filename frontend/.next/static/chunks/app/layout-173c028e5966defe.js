(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1290:()=>{},2853:(e,t,a)=>{"use strict";a.d(t,{Hh:()=>n,iD:()=>l,ri:()=>u});var r=a(3961),i=a(2553),s=a(9708);let l=async(e,t,a)=>{let l=(await (0,i.x9)(r.j2,e,t)).user,n=(0,s.H9)(r.db,"users",l.uid),u=await (0,s.x7)(n);if(u.exists()&&u.data().role===a){let e=u.data();return{id:l.uid,email:l.email,role:e.role}}throw await (0,i.CI)(r.j2),Error("Invalid credentials or role selection.")},n=async(e,t,a)=>{let l=(await (0,i.eJ)(r.j2,e,t)).user,n=(0,s.H9)(r.db,"users",l.uid);return await (0,s.BN)(n,{email:l.email,role:a,createdAt:new Date().toISOString()}),{id:l.uid,email:l.email,role:a}},u=()=>(0,i.CI)(r.j2)},3961:(e,t,a)=>{"use strict";a.d(t,{CN:()=>n,IG:()=>o,db:()=>d,j2:()=>c});var r=a(2078),i=a(9708),s=a(2553),l=a(9996);let n={apiKey:"AIzaSyAtXJsbkjxxunPT0DuW51x_kHLqCV-LW1s",authDomain:"cityfix-app-8d21f.firebaseapp.com",projectId:"cityfix-app-8d21f",storageBucket:"cityfix-app-8d21f.firebasestorage.app",messagingSenderId:"1029958752001",appId:"1:1029958752001:web:700368a08e23b96b8b2d00"},u=(0,r.Wp)(n),d=(0,i.aU)(u),c=(0,s.xI)(u),o=(0,l.c7)(u)},5384:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,1290,23)),Promise.resolve().then(a.bind(a,8839))},8839:(e,t,a)=>{"use strict";a.d(t,{default:()=>s});var r=a(5155),i=a(9293);function s(e){let{children:t}=e;return(0,r.jsx)(i.O,{children:t})}},9293:(e,t,a)=>{"use strict";a.d(t,{A:()=>o,O:()=>c});var r=a(5155),i=a(2115),s=a(2853),l=a(2553),n=a(9708),u=a(3961);let d=(0,i.createContext)(void 0),c=e=>{let{children:t}=e,[a,c]=(0,i.useState)(null),[o,x]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=(0,l.hg)(u.j2,async e=>{if(e){let t=(0,n.H9)(u.db,"users",e.uid),a=await (0,n.x7)(t);if(a.exists()){let t=a.data();c({id:e.uid,email:e.email,role:t.role})}else await s.ri(),c(null)}else c(null);x(!1)});return()=>e()},[]);let m=async()=>{await s.ri(),c(null)},h=(0,i.useMemo)(()=>({currentUser:a,setCurrentUser:c,logout:m,isLoading:o}),[a,o]);return o?(0,r.jsx)("div",{className:"min-h-screen bg-brand-gray flex justify-center items-center",children:(0,r.jsxs)("svg",{className:"animate-spin h-10 w-10 text-brand-blue",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):(0,r.jsx)(d.Provider,{value:h,children:t})},o=()=>{let e=(0,i.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[741,135,965,31,441,255,358],()=>e(e.s=5384)),_N_E=e.O()}]);