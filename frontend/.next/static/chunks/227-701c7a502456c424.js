"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[227],{2822:(e,t,a)=>{a.d(t,{Iz:()=>h,ZJ:()=>n,kw:()=>u,qP:()=>i,rA:()=>d,vD:()=>c});var s=a(8368),r=a(3961),l=a(9708),o=a(9996);let n=(e,t)=>Promise.race([new Promise(async(a,n)=>{let{photoFile:i,...c}=e,d=(()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="";for(let a=0;a<20;a++)t+=e.charAt(Math.floor(Math.random()*e.length));return t})(),u=(0,o.KR)(r.IG,"issues/".concat(d,"-").concat(i.name)),h=(0,o.bp)(u,i);h.on("state_changed",e=>{t(Math.round(e.bytesTransferred/e.totalBytes*100))},e=>{console.error("Upload failed",e),n(e)},async()=>{try{let e=await (0,o.qk)(h.snapshot.ref),t={...c,photoUrl:e,createdAt:new Date().toISOString(),status:s.A.PENDING},n=await (0,l.gS)((0,l.rJ)(r.db,"issues"),t),i={...c,id:n.id,photoUrl:e,createdAt:t.createdAt,status:t.status};a(i)}catch(e){console.error("Failed to save issue to Firestore",e),n(e)}})}),new Promise((e,t)=>{setTimeout(()=>{let e=Error("Upload timed out after 30 seconds.");e.name="UploadTimeout",t(e)},3e4)})]),i=async e=>{let t=(0,l.H9)(r.db,"issues",e),a=await (0,l.x7)(t);if(a.exists())return{id:a.id,...a.data()}},c=async(e,t)=>{let a=(0,l.H9)(r.db,"issues",e);await (0,l.mZ)(a,{status:t})},d=async(e,t)=>{let a=(0,l.H9)(r.db,"issues",e);await (0,l.mZ)(a,{priority:t})},u=async(e,t)=>{let a=(0,l.H9)(r.db,"issues",e);await (0,l.mZ)(a,{actionPlan:t})},h=async()=>{console.log("Seeding initial issues...");let e=(0,l.rJ)(r.db,"issues"),t=[{title:"Major Pothole on University Road",description:"A very large and dangerous pothole has formed near the main gate of the university. It's causing traffic issues and could damage vehicles.",summary:"A large, dangerous pothole is causing traffic problems near the university.",photoUrl:"https://picsum.photos/seed/pothole/800/600",tags:["road_damage","pothole","traffic_hazard"],priority:s.b.HIGH,location:{lat:21.1702,lon:72.8311},status:s.A.PENDING,createdAt:new Date(Date.now()-1728e5).toISOString()},{title:"Streetlight Out at City Park Corner",description:"The streetlight at the corner of City Park and 5th Avenue has been out for three nights. It's very dark and feels unsafe.",summary:"A streetlight is out, creating a dark and potentially unsafe area at a park corner.",photoUrl:"https://picsum.photos/seed/streetlight/800/600",tags:["street_light","public_safety","electrical"],priority:s.b.MEDIUM,location:{lat:21.1959,lon:72.8302},status:s.A.IN_PROGRESS,createdAt:new Date(Date.now()-432e6).toISOString(),actionPlan:{steps:["Inspect fixture and wiring","Replace bulb and ballast","Verify timer functionality"],crew:"Electrical Services",estimatedHours:2}},{title:"Overflowing Public Trash Can",description:"The trash can at the bus stop on Diamond Street is completely full and overflowing. Garbage is blowing into the street.",summary:"A public trash can at a bus stop is overflowing, causing a sanitation issue.",photoUrl:"https://picsum.photos/seed/trash/800/600",tags:["sanitation","waste_management","public_space"],priority:s.b.LOW,location:{lat:21.2084,lon:72.8408},status:s.A.RESOLVED,createdAt:new Date(Date.now()-864e6).toISOString()},{title:"Broken Bench in Central Park",description:"One of the wooden benches near the fountain in Central Park has a broken leg and is unusable. It could be a safety hazard for children.",summary:"A park bench is broken and unusable, posing a potential safety risk.",photoUrl:"https://picsum.photos/seed/bench/800/600",tags:["park_maintenance","vandalism","public_furniture"],priority:s.b.MEDIUM,location:{lat:21.1775,lon:72.8165},status:s.A.PENDING,createdAt:new Date().toISOString()}];try{for(let a of t)await (0,l.gS)(e,a);console.log("Finished seeding issues.")}catch(e){console.error("Error seeding database: ",e)}}},2853:(e,t,a)=>{a.d(t,{Hh:()=>n,iD:()=>o,ri:()=>i});var s=a(3961),r=a(2553),l=a(9708);let o=async(e,t,a)=>{let o=(await (0,r.x9)(s.j2,e,t)).user,n=(0,l.H9)(s.db,"users",o.uid),i=await (0,l.x7)(n);if(i.exists()&&i.data().role===a){let e=i.data();return{id:o.uid,email:o.email,role:e.role}}throw await (0,r.CI)(s.j2),Error("Invalid credentials or role selection.")},n=async(e,t,a)=>{let o=(await (0,r.eJ)(s.j2,e,t)).user,n=(0,l.H9)(s.db,"users",o.uid);return await (0,l.BN)(n,{email:o.email,role:a,createdAt:new Date().toISOString()}),{id:o.uid,email:o.email,role:a}},i=()=>(0,r.CI)(s.j2)},3961:(e,t,a)=>{a.d(t,{CN:()=>n,IG:()=>u,db:()=>c,j2:()=>d});var s=a(2078),r=a(9708),l=a(2553),o=a(9996);let n={apiKey:"AIzaSyAtXJsbkjxxunPT0DuW51x_kHLqCV-LW1s",authDomain:"cityfix-app-8d21f.firebaseapp.com",projectId:"cityfix-app-8d21f",storageBucket:"cityfix-app-8d21f.firebasestorage.app",messagingSenderId:"1029958752001",appId:"1:1029958752001:web:700368a08e23b96b8b2d00"},i=(0,s.Wp)(n),c=(0,r.aU)(i),d=(0,l.xI)(i),u=(0,o.c7)(i)},5602:(e,t,a)=>{a.d(t,{JE:()=>n,oG:()=>l,wJ:()=>o});var s=a(8368),r=a(2822);let l=async(e,t,a)=>{try{let s=await fetch("/api/gemini/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:e,imageBase64:t,imageMimeType:a})});if(!s.ok)throw Error("Gemini analyze failed: ".concat(s.status));return await s.json()}catch(t){return console.error("Error analyzing issue from Gemini:",t),{tags:["issue"],summary:e.substring(0,100)+(e.length>100?"...":""),priority:s.b.MEDIUM}}},o=async e=>{let t=await fetch("/api/gemini/plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({issue:e})});if(!t.ok){let e=await t.text();throw Error("Failed to generate action plan: ".concat(e))}return await t.json()},n=async e=>{if(!e)return"Please provide a report ID (e.g., 'What is the status of a report? Please include the full ID.').";let t=await (0,r.qP)(e.trim());return t?"Report ".concat(t.id,' ( "').concat(t.title,'" ) is currently marked as: ').concat(t.status,". It was reported on ").concat(new Date(t.createdAt).toLocaleDateString(),"."):'Sorry, I could not find any report with the ID "'.concat(e,'". Please check the ID and try again.')}},6059:(e,t,a)=>{a.d(t,{A:()=>x});var s=a(5155),r=a(2115),l=a(8368);let o={[l.A.PENDING]:"bg-yellow-100 text-yellow-800 border-yellow-300",[l.A.IN_PROGRESS]:"bg-blue-100 text-blue-800 border-blue-300",[l.A.RESOLVED]:"bg-green-100 text-green-800 border-green-300"},n={[l.b.LOW]:"bg-gray-100 text-gray-800 border-gray-300",[l.b.MEDIUM]:"bg-orange-100 text-orange-800 border-orange-300",[l.b.HIGH]:"bg-red-100 text-red-800 border-red-300",[l.b.CRITICAL]:"bg-purple-100 text-purple-800 border-purple-300 animate-pulse"},i={[l.A.PENDING]:"#FBBF24",[l.A.IN_PROGRESS]:"#60A5FA",[l.A.RESOLVED]:"#4ADE80"};var c=a(5602),d=a(2822);let u=e=>{let{plan:t,issueId:a,onClose:r}=e;return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",onClick:r,role:"dialog","aria-modal":"true","aria-labelledby":"action-plan-title",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,s.jsx)("h2",{id:"action-plan-title",className:"text-xl font-bold text-brand-dark",children:"Suggested Action Plan"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["For Report ID: ",(0,s.jsx)("span",{className:"font-mono",children:a})]})]}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-md font-semibold text-gray-700 flex items-center gap-2",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-brand-blue",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,s.jsx)("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z",clipRule:"evenodd"})]}),"Suggested Steps"]}),(0,s.jsx)("ul",{className:"list-decimal list-inside mt-2 space-y-2 text-sm text-gray-800 bg-gray-50 p-4 rounded-md",children:t.steps.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-center",children:[(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-700",children:"Required Crew"}),(0,s.jsx)("p",{className:"text-lg font-bold text-brand-blue mt-1",children:t.crew})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-700",children:"Estimated Resolution Time"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-brand-blue mt-1",children:[t.estimatedHours," Hours"]})]})]})]}),(0,s.jsx)("div",{className:"p-4 bg-gray-50 rounded-b-lg text-right",children:(0,s.jsx)("button",{onClick:r,className:"px-4 py-2 bg-brand-blue text-white text-sm font-medium rounded-md hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue",children:"Close"})})]})})},h=e=>{let{issue:t,currentUser:a,onStatusChange:i,onPriorityChange:h}=e,[m,g]=(0,r.useState)(!1),[p,x]=(0,r.useState)(!1),[f,b]=(0,r.useState)(null),[w,y]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=()=>y((e=>{let t=Math.floor((new Date().getTime()-new Date(e).getTime())/1e3),a=t/31536e3;return a>1?Math.floor(a)+" years ago":(a=t/2592e3)>1?Math.floor(a)+" months ago":(a=t/86400)>1?Math.floor(a)+" days ago":(a=t/3600)>1?Math.floor(a)+" hours ago":(a=t/60)>1?Math.floor(a)+" minutes ago":Math.floor(t)+" seconds ago"})(t.createdAt));e();let a=setInterval(e,6e4);return()=>clearInterval(a)},[t.createdAt]);let v=e=>{i(t.id,e.target.value)},j=e=>{h(t.id,e.target.value)},N=async()=>{g(!0),b(null);try{let e=await c.wJ(t);await d.kw(t.id,e)}catch(e){b(e.message)}finally{g(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden transition-transform duration-300 hover:shadow-2xl flex flex-col",children:[(0,s.jsx)("img",{className:"h-48 w-full object-cover",src:t.photoUrl,alt:t.title,loading:"lazy"}),(0,s.jsxs)("div",{className:"p-5 flex flex-col flex-grow",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2 gap-2",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-brand-dark leading-tight flex-1 break-anywhere",children:t.title}),"admin"===a.role?(0,s.jsx)(()=>(0,s.jsxs)("div",{className:"flex flex-col items-end gap-2 flex-shrink-0",children:[(0,s.jsxs)("select",{value:t.status,onChange:v,className:"text-xs font-semibold rounded-full border cursor-pointer focus:ring-2 focus:ring-brand-blue focus:outline-none ".concat(o[t.status]),style:{WebkitAppearance:"none",appearance:"none",padding:"0.25rem 0.75rem"},children:[(0,s.jsx)("option",{value:l.A.PENDING,children:"Pending"}),(0,s.jsx)("option",{value:l.A.IN_PROGRESS,children:"In Progress"}),(0,s.jsx)("option",{value:l.A.RESOLVED,children:"Resolved"})]}),(0,s.jsxs)("select",{value:t.priority,onChange:j,className:"text-xs font-semibold rounded-full border cursor-pointer focus:ring-2 focus:ring-brand-blue focus:outline-none ".concat(n[t.priority]),style:{WebkitAppearance:"none",appearance:"none",padding:"0.25rem 0.75rem"},children:[(0,s.jsx)("option",{value:l.b.LOW,children:"Low"}),(0,s.jsx)("option",{value:l.b.MEDIUM,children:"Medium"}),(0,s.jsx)("option",{value:l.b.HIGH,children:"High"}),(0,s.jsx)("option",{value:l.b.CRITICAL,children:"Critical"})]})]}),{}):(0,s.jsx)(()=>(0,s.jsxs)("div",{className:"flex flex-col items-end gap-2 flex-shrink-0",children:[(0,s.jsx)("span",{className:"px-3 py-1 text-xs font-semibold rounded-full border ".concat(o[t.status]),children:t.status}),(0,s.jsxs)("span",{className:"px-3 py-1 text-xs font-semibold rounded-full border flex items-center gap-1.5 ".concat(n[t.priority]),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M3 6a3 3 0 013-3h10a1 1 0 01.8 1.6L14.25 8l2.55 3.4A1 1 0 0116 13H6a1 1 0 01-1-1V6z",clipRule:"evenodd"})}),t.priority," Priority"]})]}),{})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-4 flex-grow italic",children:['"',t.summary,'"']}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[t.tags.map(e=>(0,s.jsxs)("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 text-xs font-medium rounded-full",children:["#",e]},e)),t.category&&(0,s.jsx)("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-700 text-xs font-semibold rounded-full",title:t.category_confidence?"Confidence ".concat((100*t.category_confidence).toFixed(0),"%"):void 0,children:t.category}),t.duplicate_of&&(0,s.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-semibold rounded-full",title:t.duplicate_similarity?"Similarity ".concat((100*t.duplicate_similarity).toFixed(0),"%"):void 0,children:"Linked duplicate"})]}),"admin"===a.role&&(0,s.jsx)("div",{className:"my-2",children:t.actionPlan?(0,s.jsxs)("div",{className:"bg-green-50 border border-green-200 p-3 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-green-800",children:"Action Plan Created"}),(0,s.jsxs)("p",{className:"text-xs text-green-700 mt-1",children:["Crew: ",t.actionPlan.crew]}),(0,s.jsx)("button",{onClick:()=>x(!0),className:"mt-2 text-sm font-bold text-green-800 hover:underline",children:"View Full Plan"})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{onClick:N,disabled:m,className:"w-full flex justify-center items-center gap-2 px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-brand-lightblue hover:bg-brand-blue focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue disabled:bg-gray-400",children:m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating Plan..."]}):"Suggest Action Plan"}),f&&(0,s.jsx)("p",{className:"text-xs text-red-600 mt-1",children:f})]})}),(0,s.jsxs)("div",{className:"mt-auto pt-4 border-t border-gray-200 text-xs text-gray-500 space-y-2",children:[t.ai_reason&&(0,s.jsxs)("div",{className:"flex items-start gap-2 text-gray-600",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mt-0.5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{d:"M18 10A8 8 0 11.001 10 8 8 0 0118 10zM9 5a1 1 0 112 0v2a1 1 0 11-2 0V5zm1 10a1 1 0 100-2 1 1 0 000 2z"})}),(0,s.jsxs)("span",{children:["AI note: ",t.ai_reason]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v5.586l1.293-1.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L11 10.414V5z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"font-mono break-anywhere",children:t.id})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{children:t.location?"".concat(t.location.lat.toFixed(4),", ").concat(t.location.lon.toFixed(4)):"N/A"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.414-1.415L11 9.586V6z",clipRule:"evenodd"})}),(0,s.jsxs)("span",{suppressHydrationWarning:!0,children:["Reported ",null!=w?w:"..."]})]})]})]})]}),p&&t.actionPlan&&(0,s.jsx)(u,{plan:t.actionPlan,issueId:t.id,onClose:()=>x(!1)})]})};var m=a(3961);let g=e=>{let{issues:t}=e,a=(0,r.useRef)(null),l=(0,r.useRef)(null),o=(0,r.useRef)([]),[n,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(null),h="YOUR_API_KEY_HERE"===m.CN.apiKey||!m.CN.apiKey;return((0,r.useEffect)(()=>{if(window.gm_authFailure=()=>{u('Google Maps Authentication Error. Please check the following in your Google Cloud Console for this project: 1) The "Maps JavaScript API" is enabled. 2) A billing account is linked to the project. 3) The API key has no restrictive HTTP referrers, or the current URL is allowed. For more details, open your browser\'s developer console.')},h)return void u("The map requires a valid API key. Please open the 'services/firebase.ts' file and replace the placeholder 'YOUR_API_KEY_HERE' with the actual Web API Key from your Firebase project's settings. Note: Login may work without this, but the map will not.");if(m.CN.apiKey){let e;(e=m.CN.apiKey,new Promise((t,a)=>{if(window.google&&window.google.maps)return t();let s="google-maps-script";if(document.getElementById(s)){let e=setInterval(()=>{window.google&&window.google.maps&&(clearInterval(e),t())},100);return}let r=document.createElement("script");r.id=s,r.src="https://maps.googleapis.com/maps/api/js?key=".concat(e),r.async=!0,r.defer=!0,r.onload=()=>t(),r.onerror=()=>a(Error("Google Maps script could not be loaded. Please check your network connection.")),document.head.appendChild(r)})).then(()=>c(!0)).catch(e=>{console.error(e),u("".concat(e.message," For more details, check your browser's developer console (F12) for specific errors from Google Maps."))})}else{let e="Google Maps could not be loaded. The API key is missing from the 'services/firebase.ts' configuration file.";console.error(e),u(e)}return()=>{delete window.gm_authFailure}},[]),(0,r.useEffect)(()=>{if(n&&!d&&a.current){if(!l.current){let e=t.filter(e=>e.location),s={lat:21.1702,lng:72.8311};if(e.length>0){let t=e.reduce((e,t)=>e+t.location.lat,0),a=e.reduce((e,t)=>e+t.location.lon,0);s={lat:t/e.length,lng:a/e.length}}l.current=new window.google.maps.Map(a.current,{center:s,zoom:e.length>0?12:10,mapId:"RIFI_MAP",disableDefaultUI:!0,zoomControl:!0,clickableIcons:!1})}let e=l.current;o.current.forEach(e=>e.setMap(null)),o.current=[],t.filter(e=>e.location).forEach(t=>{let a={path:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fillColor:i[t.status],fillOpacity:1,strokeWeight:1,strokeColor:"#fff",rotation:0,scale:1.5,anchor:new window.google.maps.Point(12,24)},s=new window.google.maps.Marker({position:{lat:t.location.lat,lng:t.location.lon},map:e,icon:a,title:t.title}),r=new window.google.maps.InfoWindow({content:'<div style="color: #1F2937; font-family: sans-serif; max-width: 200px;">\n                            <strong style="font-size: 1.1em;">'.concat(t.title,'</strong>\n                            <p style="margin: 4px 0;"><strong>Priority:</strong> ').concat(t.priority,'</p>\n                            <p style="font-style: italic; margin: 4px 0 0 0;">"').concat(t.summary,'"</p>\n                         </div>')});s.addListener("click",()=>{r.open(e,s)}),o.current.push(s)})}},[n,t,d]),d)?(0,s.jsx)("div",{className:"h-[400px] w-full bg-red-100 border border-red-300 text-red-800 rounded-lg flex items-center justify-center text-center p-4 mb-8 shadow-md",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center justify-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Map Configuration Error"]}),(0,s.jsx)("p",{className:"text-sm text-left",children:d})]})}):n?(0,s.jsx)("div",{ref:a,className:"w-full bg-gray-200 rounded-lg mb-8 shadow-md h-64 md:h-80 lg:h-96","aria-label":"Map of reported issues"}):(0,s.jsx)("div",{className:"h-[400px] w-full bg-gray-200 rounded-lg flex items-center justify-center text-center text-gray-600 p-4 mb-8 shadow-md animate-pulse",children:"Loading Map..."})},p=e=>{let{label:t,count:a,isActive:r,onClick:l}=e;return(0,s.jsxs)("button",{onClick:l,className:"px-4 py-2 text-sm font-medium rounded-full transition-colors duration-200 ".concat(r?"bg-brand-blue text-white shadow":"bg-white text-gray-700 hover:bg-gray-100"),children:[t,(0,s.jsx)("span",{className:"ml-2 inline-block px-2 py-0.5 text-xs font-semibold rounded-full ".concat(r?"bg-white text-brand-blue":"bg-gray-200 text-gray-700"),children:a})]})},x=e=>{let{issues:t,isLoading:a,currentUser:o,onStatusChange:n,onPriorityChange:i}=e,[c,d]=(0,r.useState)("all"),u=(0,r.useMemo)(()=>"all"===c?t:t.filter(e=>e.status===c),[t,c]),m=(0,r.useMemo)(()=>t.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{}),[t]);return a?(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsxs)("svg",{className:"animate-spin mx-auto h-10 w-10 text-brand-blue",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading issues..."})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-brand-dark mb-4 text-center md:text-3xl",children:"Issues Overview Map"}),(0,s.jsx)(g,{issues:t}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-2 mb-8",children:[(0,s.jsx)(p,{label:"All Issues",count:t.length,isActive:"all"===c,onClick:()=>d("all")}),(0,s.jsx)(p,{label:"Pending",count:m[l.A.PENDING]||0,isActive:c===l.A.PENDING,onClick:()=>d(l.A.PENDING)}),(0,s.jsx)(p,{label:"In Progress",count:m[l.A.IN_PROGRESS]||0,isActive:c===l.A.IN_PROGRESS,onClick:()=>d(l.A.IN_PROGRESS)}),(0,s.jsx)(p,{label:"Resolved",count:m[l.A.RESOLVED]||0,isActive:c===l.A.RESOLVED,onClick:()=>d(l.A.RESOLVED)})]}),u.length>0?(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:u.map(e=>(0,s.jsx)(h,{issue:e,currentUser:o,onStatusChange:n,onPriorityChange:i},e.id))}):(0,s.jsxs)("div",{className:"text-center py-16 px-6 bg-white rounded-lg shadow-md",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,s.jsx)("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No issues found"}),(0,s.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:['There are no issues matching the "',c,'" filter. Try another category or report a new issue!']})]})]})}},8368:(e,t,a)=>{a.d(t,{A:()=>s,b:()=>r});var s=function(e){return e.PENDING="Pending",e.IN_PROGRESS="In Progress",e.RESOLVED="Resolved",e}({}),r=function(e){return e.LOW="Low",e.MEDIUM="Medium",e.HIGH="High",e.CRITICAL="Critical",e}({})},9293:(e,t,a)=>{a.d(t,{A:()=>u,O:()=>d});var s=a(5155),r=a(2115),l=a(2853),o=a(2553),n=a(9708),i=a(3961);let c=(0,r.createContext)(void 0),d=e=>{let{children:t}=e,[a,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=(0,o.hg)(i.j2,async e=>{if(e){let t=(0,n.H9)(i.db,"users",e.uid),a=await (0,n.x7)(t);if(a.exists()){let t=a.data();d({id:e.uid,email:e.email,role:t.role})}else await l.ri(),d(null)}else d(null);h(!1)});return()=>e()},[]);let m=async()=>{await l.ri(),d(null)},g=(0,r.useMemo)(()=>({currentUser:a,setCurrentUser:d,logout:m,isLoading:u}),[a,u]);return u?(0,s.jsx)("div",{className:"min-h-screen bg-brand-gray flex justify-center items-center",children:(0,s.jsxs)("svg",{className:"animate-spin h-10 w-10 text-brand-blue",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):(0,s.jsx)(c.Provider,{value:g,children:t})},u=()=>{let e=(0,r.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}}]);